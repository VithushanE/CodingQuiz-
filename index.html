<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Javascript quiz </title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" rel="stylesheet" />
</head>

<!--Created structure of HTML-->
<body>
  <div class="container">
    <h1>Quiz Master</h1>
    <div class="alert alert-light">

      <!--Entered the buttons here-->
      <button onClick="finishQuiz(event)" class="float-end">X</button>
      <h3 id='countdown'> Timer:</h3>
    </div>

    <!-- Enter UserName First -->
    <h4>Enter User Name below!</h4>
    <div id="playname" class="card" >
      <input id="playerNameBox" >
        <!--enter player name here-->
    </input>
    <br>
    </div>
    <button class = "primarybtn" onClick= 'startQuiz()' id="startQuiz">Start Quiz</button>
     <!-- Question section -->
    <div id='quizPage' class="card">
      <form id="questionBox" class="card-body">
        <!-- put the questions in here-->
      </form>
      <div id='answerResponse' class="card-footer alert-secondary">
        Please select an answer
      </div>
  
    </div>

    <!--Score section-->
    <div id='scorePage' class="card d-none">
      <button class= "primarybtn" onClick= 'showResults()' >Click to see Scores!</button>
      <input class= "form-control" id= "userName" type='text' > 
    </div>
  </div>

  
<script type="text/javascript">
  
  // Identify the  global variables
  var countdownTimer
  var countdownValue 
  var questionNumber
  var correctAnswer = 0;
  var playName 

  // Establish all questions in the quiz 
  var questions = [
    { question: "Who started Linux?", 
      answers: [ "Justin Bieber", "Johnathan Bell", "Linus Torvalds" ],
      correct: "Linus Torvalds" },

    { question: "Who invented the iPhone?", 
      answers: [ "Hewlett Packard", "Steve Jobs", "Steve Jacobs" ],
      correct: "Steve Jobs" },
      
    { question: "Who invented the internet?",
      answers: [ "Aliens", "Europe", "DARPA" ],
      correct: "DARPA" }
  ]

 // to ensure value is entered for player name 
  function validateForm() {
  var x = document.getElementById("playerNameBox").value
  if (x == "") {
    alert("Name must be filled out");
    return false;
  }
}

  // To go from one question to the next 
  function showNextQuestion(){
    var question = questions[questionNumber]
    var questionEl = document.querySelector('#questionBox')

    // display question
    questionEl.innerHTML = `
      <div class="alert alert-warning"><h3>${question.question}</h3>
      `
    // loop through and show each answer as a button
    for( var i=0; i < question.answers.length; i++ ){
      var answer = question.answers[i]
      questionEl.innerHTML += `
      <button onClick="selectAnswer(event,'${answer}')" class="btn btn-secondary btn-block">${answer}</button>
      `
    }
  }

  function selectAnswer( event,answer ){
    event.preventDefault()
    console.log( `question answer id: ${answer}` )
    if( answer===questions[questionNumber].correct ){
      console.log( `good job! correct answer: ${answer}` )
      correctAnswer++;
    } else {
      console.log( `sorry, you lose, -10` )
      timerDecreaseAndDisplay(10)
    } 
    questionNumber++
    // decide to show next question (if more), else end quiz
    if( questionNumber<questions.length )
      showNextQuestion()
    else
      finishQuiz()
  }


  function timerDecreaseAndDisplay( byValue=1 ){
    // decrease by the value passed in, or if nothing, by 1
    countdownValue -= byValue && countdownValue >0
    document.querySelector('#countdown').textContent = countdownValue
    if( countdownValue<1 )
      finishQuiz()
  }

  function showPage( page ){
    // hide all pages
    document.querySelector('#quizPage').classList.add('d-none')
    document.querySelector('#scorePage').classList.add('d-none')
    // show selected page
    document.querySelector(`#${page}`).classList.remove('d-none')
  }

  function finishQuiz(event){
    if( event ) event.preventDefault()
    console.log( `finished` )
    // stop the countdown
    clearInterval( countdownTimer )
    // show score page
    showPage( 'scorePage' )


    }
    // display the name capture + leaderboard
    function showResults(){
      var result=correctAnswer
      console.log('You got '+ result + ' right!')
      document.getElementById('userName').value= (playName + ' got '+ result + ' right!')
      }
  

  // START: 
  // - start timer
  // - show questions
  function startQuiz(){
   playName= document.querySelector('#playerNameBox').value
    questionNumber = 0
    countdownValue = 60
    countdownTimer = setInterval( timerDecreaseAndDisplay, 1000 )
    // switch back to the quizPage
    showPage( 'quizPage' )
    showNextQuestion()
  }



</script>

</body>

</html>

